{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"]}},{"name":"expo-router","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":62,"index":62}}],"key":"/+ErnBisjrT6aDU+GRp5Qz/lYoY=","exportNames":["*"]}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":63},"end":{"line":2,"column":34,"index":97}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"]}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"]}},{"name":"react-native-webview","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":139},"end":{"line":4,"column":47,"index":186}}],"key":"YJc7i/oIweCWhKjzjfYLEcLeUJA=","exportNames":["*"]}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = Stripe;\n  var _env2 = require(_dependencyMap[1], \"expo/virtual/env\");\n  var _expoRouter = require(_dependencyMap[2], \"expo-router\");\n  var _react = require(_dependencyMap[3], \"react\");\n  var _Platform = _interopRequireDefault(require(_dependencyMap[4], \"react-native-web/dist/exports/Platform\"));\n  var _reactNativeWebview = require(_dependencyMap[5], \"react-native-webview\");\n  var _jsxDevRuntime = require(_dependencyMap[6], \"react/jsx-dev-runtime\");\n  var _jsxFileName = \"/tmp/cc-agent/60860651/project/apps/mobile/src/app/stripe.jsx\",\n    _s = $RefreshSig$();\n  function Stripe() {\n    _s();\n    const {\n      checkoutUrl,\n      masterId,\n      sessionId,\n      type\n    } = (0, _expoRouter.useLocalSearchParams)();\n    const router = (0, _expoRouter.useRouter)();\n    (0, _react.useEffect)(() => {\n      if (_Platform.default.OS === \"web\") {\n        if (checkoutUrl) {\n          const popup = window.open(checkoutUrl, \"_blank\", \"popup\");\n          const checkClosed = setInterval(() => {\n            try {\n              if (popup.closed || popup.location.href.includes(_env2.env.EXPO_PUBLIC_PROXY_BASE_URL || _env2.env.EXPO_PUBLIC_BASE_URL)) {\n                clearInterval(checkClosed);\n                popup.close();\n                router.back();\n              }\n            } catch (e) {}\n          }, 1000);\n        } else {\n          router.back();\n        }\n      }\n    }, [checkoutUrl, router]);\n    const handleWebViewClose = () => {\n      router.back();\n    };\n    const handleShouldStartLoadWithRequest = request => {\n      const baseUrl = _env2.env.EXPO_PUBLIC_PROXY_BASE_URL || _env2.env.EXPO_PUBLIC_BASE_URL;\n      if (request.url.includes(baseUrl)) {\n        // Check if payment was successful\n        if (request.url.includes(\"session_id=\")) {\n          const url = new URL(request.url);\n          const sessionId = url.searchParams.get(\"session_id\");\n          const paymentType = url.searchParams.get(\"type\");\n          const masterId = url.searchParams.get(\"master_id\");\n          const bookingSessionId = url.searchParams.get(\"booking_session_id\");\n\n          // Verify payment in background\n          fetch(\"/api/verify-payment\", {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\"\n            },\n            body: JSON.stringify({\n              sessionId,\n              type: paymentType,\n              masterId,\n              bookingSessionId\n            })\n          }).then(() => {\n            handleWebViewClose();\n          }).catch(() => {\n            handleWebViewClose();\n          });\n        } else {\n          handleWebViewClose();\n        }\n        return false;\n      }\n      return true;\n    };\n    if (_Platform.default.OS === \"web\") {\n      return null;\n    }\n    return /*#__PURE__*/(0, _jsxDevRuntime.jsxDEV)(_reactNativeWebview.WebView, {\n      source: {\n        uri: checkoutUrl\n      },\n      style: {\n        flex: 1\n      },\n      onShouldStartLoadWithRequest: handleShouldStartLoadWithRequest\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 5\n    }, this);\n  }\n  _s(Stripe, \"f9wrYpySL661krMrzWCV4njDURY=\", false, function () {\n    return [_expoRouter.useLocalSearchParams, _expoRouter.useRouter];\n  });\n  _c = Stripe;\n  var _c;\n  $RefreshReg$(_c, \"Stripe\");\n});","lineCount":103,"map":[[8,2,1,0],[8,6,1,0,"_expoRouter"],[8,17,1,0],[8,20,1,0,"require"],[8,27,1,0],[8,28,1,0,"_dependencyMap"],[8,42,1,0],[9,2,2,0],[9,6,2,0,"_react"],[9,12,2,0],[9,15,2,0,"require"],[9,22,2,0],[9,23,2,0,"_dependencyMap"],[9,37,2,0],[10,2,2,34],[10,6,2,34,"_Platform"],[10,15,2,34],[10,18,2,34,"_interopRequireDefault"],[10,40,2,34],[10,41,2,34,"require"],[10,48,2,34],[10,49,2,34,"_dependencyMap"],[10,63,2,34],[11,2,4,0],[11,6,4,0,"_reactNativeWebview"],[11,25,4,0],[11,28,4,0,"require"],[11,35,4,0],[11,36,4,0,"_dependencyMap"],[11,50,4,0],[12,2,4,47],[12,6,4,47,"_jsxDevRuntime"],[12,20,4,47],[12,23,4,47,"require"],[12,30,4,47],[12,31,4,47,"_dependencyMap"],[12,45,4,47],[13,2,4,47],[13,6,4,47,"_jsxFileName"],[13,18,4,47],[14,4,4,47,"_s"],[14,6,4,47],[14,9,4,47,"$RefreshSig$"],[14,21,4,47],[15,2,6,15],[15,11,6,24,"Stripe"],[15,17,6,30,"Stripe"],[15,18,6,30],[15,20,6,33],[16,4,6,33,"_s"],[16,6,6,33],[17,4,7,2],[17,10,7,8],[18,6,7,10,"checkoutUrl"],[18,17,7,21],[19,6,7,23,"masterId"],[19,14,7,31],[20,6,7,33,"sessionId"],[20,15,7,42],[21,6,7,44,"type"],[22,4,7,49],[22,5,7,50],[22,8,7,53],[22,12,7,53,"useLocalSearchParams"],[22,44,7,73],[22,46,7,74],[22,47,7,75],[23,4,8,2],[23,10,8,8,"router"],[23,16,8,14],[23,19,8,17],[23,23,8,17,"useRouter"],[23,44,8,26],[23,46,8,27],[23,47,8,28],[24,4,10,2],[24,8,10,2,"useEffect"],[24,24,10,11],[24,26,10,12],[24,32,10,18],[25,6,11,4],[25,10,11,8,"Platform"],[25,27,11,16],[25,28,11,17,"OS"],[25,30,11,19],[25,35,11,24],[25,40,11,29],[25,42,11,31],[26,8,12,6],[26,12,12,10,"checkoutUrl"],[26,23,12,21],[26,25,12,23],[27,10,13,8],[27,16,13,14,"popup"],[27,21,13,19],[27,24,13,22,"window"],[27,30,13,28],[27,31,13,29,"open"],[27,35,13,33],[27,36,13,34,"checkoutUrl"],[27,47,13,45],[27,49,13,47],[27,57,13,55],[27,59,13,57],[27,66,13,64],[27,67,13,65],[28,10,14,8],[28,16,14,14,"checkClosed"],[28,27,14,25],[28,30,14,28,"setInterval"],[28,41,14,39],[28,42,14,40],[28,48,14,46],[29,12,15,10],[29,16,15,14],[30,14,16,12],[30,18,17,14,"popup"],[30,23,17,19],[30,24,17,20,"closed"],[30,30,17,26],[30,34,18,14,"popup"],[30,39,18,19],[30,40,18,20,"location"],[30,48,18,28],[30,49,18,29,"href"],[30,53,18,33],[30,54,18,34,"includes"],[30,62,18,42],[30,63,19,16,"_env2"],[30,68,19,16],[30,69,19,16,"env"],[30,72,19,16],[30,73,19,16,"EXPO_PUBLIC_PROXY_BASE_URL"],[30,99,19,16],[30,103,19,16,"_env2"],[30,108,19,16],[30,109,19,16,"env"],[30,112,19,16],[30,113,19,16,"EXPO_PUBLIC_BASE_URL"],[30,133,21,14],[30,134,21,15],[30,136,22,14],[31,16,23,14,"clearInterval"],[31,29,23,27],[31,30,23,28,"checkClosed"],[31,41,23,39],[31,42,23,40],[32,16,24,14,"popup"],[32,21,24,19],[32,22,24,20,"close"],[32,27,24,25],[32,28,24,26],[32,29,24,27],[33,16,25,14,"router"],[33,22,25,20],[33,23,25,21,"back"],[33,27,25,25],[33,28,25,26],[33,29,25,27],[34,14,26,12],[35,12,27,10],[35,13,27,11],[35,14,27,12],[35,21,27,19,"e"],[35,22,27,20],[35,24,27,22],[35,25,27,23],[36,10,28,8],[36,11,28,9],[36,13,28,11],[36,17,28,15],[36,18,28,16],[37,8,29,6],[37,9,29,7],[37,15,29,13],[38,10,30,8,"router"],[38,16,30,14],[38,17,30,15,"back"],[38,21,30,19],[38,22,30,20],[38,23,30,21],[39,8,31,6],[40,6,32,4],[41,4,33,2],[41,5,33,3],[41,7,33,5],[41,8,33,6,"checkoutUrl"],[41,19,33,17],[41,21,33,19,"router"],[41,27,33,25],[41,28,33,26],[41,29,33,27],[42,4,35,2],[42,10,35,8,"handleWebViewClose"],[42,28,35,26],[42,31,35,29,"handleWebViewClose"],[42,32,35,29],[42,37,35,35],[43,6,36,4,"router"],[43,12,36,10],[43,13,36,11,"back"],[43,17,36,15],[43,18,36,16],[43,19,36,17],[44,4,37,2],[44,5,37,3],[45,4,39,2],[45,10,39,8,"handleShouldStartLoadWithRequest"],[45,42,39,40],[45,45,39,44,"request"],[45,52,39,51],[45,56,39,56],[46,6,40,4],[46,12,40,10,"baseUrl"],[46,19,40,17],[46,22,41,6,"_env2"],[46,27,41,6],[46,28,41,6,"env"],[46,31,41,6],[46,32,41,6,"EXPO_PUBLIC_PROXY_BASE_URL"],[46,58,41,6],[46,62,41,6,"_env2"],[46,67,41,6],[46,68,41,6,"env"],[46,71,41,6],[46,72,41,6,"EXPO_PUBLIC_BASE_URL"],[46,92,42,38],[47,6,43,4],[47,10,43,8,"request"],[47,17,43,15],[47,18,43,16,"url"],[47,21,43,19],[47,22,43,20,"includes"],[47,30,43,28],[47,31,43,29,"baseUrl"],[47,38,43,36],[47,39,43,37],[47,41,43,39],[48,8,44,6],[49,8,45,6],[49,12,45,10,"request"],[49,19,45,17],[49,20,45,18,"url"],[49,23,45,21],[49,24,45,22,"includes"],[49,32,45,30],[49,33,45,31],[49,46,45,44],[49,47,45,45],[49,49,45,47],[50,10,46,8],[50,16,46,14,"url"],[50,19,46,17],[50,22,46,20],[50,26,46,24,"URL"],[50,29,46,27],[50,30,46,28,"request"],[50,37,46,35],[50,38,46,36,"url"],[50,41,46,39],[50,42,46,40],[51,10,47,8],[51,16,47,14,"sessionId"],[51,25,47,23],[51,28,47,26,"url"],[51,31,47,29],[51,32,47,30,"searchParams"],[51,44,47,42],[51,45,47,43,"get"],[51,48,47,46],[51,49,47,47],[51,61,47,59],[51,62,47,60],[52,10,48,8],[52,16,48,14,"paymentType"],[52,27,48,25],[52,30,48,28,"url"],[52,33,48,31],[52,34,48,32,"searchParams"],[52,46,48,44],[52,47,48,45,"get"],[52,50,48,48],[52,51,48,49],[52,57,48,55],[52,58,48,56],[53,10,49,8],[53,16,49,14,"masterId"],[53,24,49,22],[53,27,49,25,"url"],[53,30,49,28],[53,31,49,29,"searchParams"],[53,43,49,41],[53,44,49,42,"get"],[53,47,49,45],[53,48,49,46],[53,59,49,57],[53,60,49,58],[54,10,50,8],[54,16,50,14,"bookingSessionId"],[54,32,50,30],[54,35,50,33,"url"],[54,38,50,36],[54,39,50,37,"searchParams"],[54,51,50,49],[54,52,50,50,"get"],[54,55,50,53],[54,56,50,54],[54,76,50,74],[54,77,50,75],[56,10,52,8],[57,10,53,8,"fetch"],[57,15,53,13],[57,16,53,14],[57,37,53,35],[57,39,53,37],[58,12,54,10,"method"],[58,18,54,16],[58,20,54,18],[58,26,54,24],[59,12,55,10,"headers"],[59,19,55,17],[59,21,55,19],[60,14,55,21],[60,28,55,35],[60,30,55,37],[61,12,55,56],[61,13,55,57],[62,12,56,10,"body"],[62,16,56,14],[62,18,56,16,"JSON"],[62,22,56,20],[62,23,56,21,"stringify"],[62,32,56,30],[62,33,56,31],[63,14,57,12,"sessionId"],[63,23,57,21],[64,14,58,12,"type"],[64,18,58,16],[64,20,58,18,"paymentType"],[64,31,58,29],[65,14,59,12,"masterId"],[65,22,59,20],[66,14,60,12,"bookingSessionId"],[67,12,61,10],[67,13,61,11],[68,10,62,8],[68,11,62,9],[68,12,62,10],[68,13,63,11,"then"],[68,17,63,15],[68,18,63,16],[68,24,63,22],[69,12,64,12,"handleWebViewClose"],[69,30,64,30],[69,31,64,31],[69,32,64,32],[70,10,65,10],[70,11,65,11],[70,12,65,12],[70,13,66,11,"catch"],[70,18,66,16],[70,19,66,17],[70,25,66,23],[71,12,67,12,"handleWebViewClose"],[71,30,67,30],[71,31,67,31],[71,32,67,32],[72,10,68,10],[72,11,68,11],[72,12,68,12],[73,8,69,6],[73,9,69,7],[73,15,69,13],[74,10,70,8,"handleWebViewClose"],[74,28,70,26],[74,29,70,27],[74,30,70,28],[75,8,71,6],[76,8,72,6],[76,15,72,13],[76,20,72,18],[77,6,73,4],[78,6,74,4],[78,13,74,11],[78,17,74,15],[79,4,75,2],[79,5,75,3],[80,4,77,2],[80,8,77,6,"Platform"],[80,25,77,14],[80,26,77,15,"OS"],[80,28,77,17],[80,33,77,22],[80,38,77,27],[80,40,77,29],[81,6,78,4],[81,13,78,11],[81,17,78,15],[82,4,79,2],[83,4,81,2],[83,24,82,4],[83,28,82,4,"_jsxDevRuntime"],[83,42,82,4],[83,43,82,4,"jsxDEV"],[83,49,82,4],[83,51,82,5,"_reactNativeWebview"],[83,70,82,5],[83,71,82,5,"WebView"],[83,78,82,12],[84,6,83,6,"source"],[84,12,83,12],[84,14,83,14],[85,8,83,16,"uri"],[85,11,83,19],[85,13,83,21,"checkoutUrl"],[86,6,83,33],[86,7,83,35],[87,6,84,6,"style"],[87,11,84,11],[87,13,84,13],[88,8,84,15,"flex"],[88,12,84,19],[88,14,84,21],[89,6,84,23],[89,7,84,25],[90,6,85,6,"onShouldStartLoadWithRequest"],[90,34,85,34],[90,36,85,36,"handleShouldStartLoadWithRequest"],[91,4,85,69],[92,6,85,69,"fileName"],[92,14,85,69],[92,16,85,69,"_jsxFileName"],[92,28,85,69],[93,6,85,69,"lineNumber"],[93,16,85,69],[94,6,85,69,"columnNumber"],[94,18,85,69],[95,4,85,69],[95,11,86,5],[95,12,86,6],[96,2,88,0],[97,2,88,1,"_s"],[97,4,88,1],[97,5,6,24,"Stripe"],[97,11,6,30],[98,4,6,30],[98,12,7,53,"useLocalSearchParams"],[98,44,7,73],[98,46,8,17,"useRouter"],[98,67,8,26],[99,2,8,26],[100,2,8,26,"_c"],[100,4,8,26],[100,7,6,24,"Stripe"],[100,13,6,30],[101,2,6,30],[101,6,6,30,"_c"],[101,8,6,30],[102,2,6,30,"$RefreshReg$"],[102,14,6,30],[102,15,6,30,"_c"],[102,17,6,30],[103,0,6,30],[103,3]],"functionMap":{"names":["<global>","Stripe","useEffect$argument_0","setInterval$argument_0","handleWebViewClose","handleShouldStartLoadWithRequest","fetch.then$argument_0","fetch.then._catch$argument_0"],"mappings":"AAA;eCK;YCI;wCCI;SDc;GDK;6BGE;GHE;2CIE;gBCwB;WDE;iBEC;WFE;GJO;CDa"}},"type":"js/module"}]}